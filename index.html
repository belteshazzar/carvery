<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Carvery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
  <div id="wrap">
    <canvas id="glcanvas" tabindex="0" aria-label="WebGL voxel editor"></canvas>

    <!-- Controls panel -->
    <div class="panel" id="panel">
      <h4>Palette — click a swatch to select; toggle <span class="kbd">Edit Palette</span> to change colors</h4>

      <!-- Palette control row -->
      <div class="row">
        <label class="chk"><input type="checkbox" id="editPaletteChk" /> Edit Palette</label>
        <button class="btn" id="resetPaletteBtn" title="Reset the 16 colors to defaults">Reset Palette</button>
        <span class="note">Palette auto‑saves to <code>localStorage</code>. Painting stores <em>palette indices</em>.</span>
      </div>

      <!-- 16 swatches -->
      <div class="swatches" id="swatches"></div>

      <!-- Row Carve -->
      <div class="row">
        <strong>Row Carve axis:</strong>
        <label class="chk"><input type="radio" name="carveAxis" value="X" checked /> X</label>
        <label class="chk"><input type="radio" name="carveAxis" value="Y" /> Y</label>
        <label class="chk"><input type="radio" name="carveAxis" value="Z" /> Z</label>
        <span class="note">Hold <span class="kbd">Alt</span> to preview; <span class="kbd">Alt + Click</span> to carve entire row.</span>
      </div>

      <!-- Undo/Redo -->
      <div class="row">
        <button class="btn" id="undoBtn" title="Undo (Ctrl/Cmd+Z)">Undo</button>
        <button class="btn" id="redoBtn" title="Redo (Ctrl/Cmd+Y or Ctrl/Cmd+Shift+Z)">Redo</button>
        <span style="font-size:12px;color:#9fb0c7">Stack: <span id="stackInfo">0 / 0</span></span>
      </div>

      <!-- Save/Load JSON -->
      <div class="row">
        <button class="btn" id="saveBtn" title="Save scene to JSON (version 2)">Save JSON</button>
        <button class="btn" id="loadBtn" title="Load scene from JSON (version 2)">Load JSON</button>
        <input type="file" id="fileInput" accept="application/json,.json" />
      </div>
      <div class="note">Tip: you can also drag a <code>.json</code> file onto the canvas to load.</div>

      <!-- OBJ Export -->
      <div class="row">
        <button class="btn" id="saveObjBtn" title="Export OBJ (geometry only)">Save OBJ</button>
        <button class="btn" id="saveObjMtlBtn" title="Export OBJ + MTL (with colors)">Save OBJ + MTL</button>
      </div>
      <div class="note">OBJ+MTL exports per‑triangle materials with <code>Kd</code> set to face colors.</div>
    </div>

    <footer>
      <div>
        Hover = preview. Click = remove. <strong>Shift + Click = add</strong>.
        <strong>Ctrl/Cmd + Click = paint face</strong>. <strong>Alt + Click = carve row</strong>.
        Drag to orbit. Wheel to zoom. Undo (Ctrl/Cmd+Z), Redo (Ctrl/Cmd+Y or Ctrl/Cmd+Shift+Z).
      </div>
      <div class="stats">
        Verts: <span id="verts">–</span> | Tris: <span id="tris">–</span> | Faces: <span id="faces">–</span>
      </div>
    </footer>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>